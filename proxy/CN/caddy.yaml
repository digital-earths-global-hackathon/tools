logging:
  filename : caddy.log
  level : info

cache_basedir : /data2/share/florain/proxy

template_cache_handle : |
    @cache_{remote_name} path /{remote_name}/*
    handle @cache_{remote_name} {{
      uri strip_prefix /{remote_name}
      #        uri replace ^ /
      cache {{
        nuts {{
          configuration {{
            Dir {cachedir}
            ttl 2d
            CommitBufferSize 419430400
            SyncEnable false
          }}
        }}
        ttl 2d
        timeout {{
          backend 120s
          cache 15s
        }}
      }}
      reverse_proxy {remote_uri} {{
        header_up Host {{upstream_hostport}}
        transport http {{
          response_header_timeout 120s
          read_timeout 120s
        }}
      }}
      header Cache-Control "public, max-age=3600"
      }}
    
  
remotes:
  - remote_name: jasmin
    remote_uri:  https://hackathon-o.s3-ext.jc.rl.ac.uk:443
  - remote_name: catalog
    remote_uri: https://digital-earths-global-hackathon.github.io:443
  - remote_name: dkrz-swift
    remote_uri: https://swift.dkrz.de:443
  - remote_name: eerie.cloud
    remote_uri: https://eerie.cloud.dkrz.de:443
  - remote_name: nowake
    remote_uri: https://nowake.nicam.jp:443
  - remote_name: dkrz-minio
    remote_uri: https://s3.eu-dkrz-1.dkrz.cloud:443

servers:
  - server_name: server06
    server_port: 2081
  - server_name: 10.2.202.6
    server_port: 2081
